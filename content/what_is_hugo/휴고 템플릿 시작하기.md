+++
title = "Introduction to Hugo Templating"
date = 2020-11-15T13:26:07+09:00
categories = ["what_is_hugo"]
tags = ["hugo","휴고","템플릿]
banner = ""
draft = true
+++

## Introduction to Hugo Templating

출처)
https://gohugo.io/templates/introduction/

휴고에선 Go의 `html/template`와 `text/template` 라이브러리를 기본적으로 템플릿화 하는데 사용할 수 있습니다.

## 기본 문법
Go Template은 변수와 함수가 더해진 HTML 파일입니다. Go Template의 변수와 함수들은 `{{ }}`를 통해 이용가능합니다.

### 사전 정의된 변수 불러오기
사전정의된 변수는 현재 스코프에 이미 존재하는 변수 (`.Title` 변수를 가져와 사용하는 것 처럼) 또는 커스텀변수(`$address`처럼) 가 될 수 있습니다.

```Go
{{ .Title }}
{{ $address }}
```

함수에 사용되는 파라미터는 분산되어 주어집니다. 다음처럼요
```Go
{{ FUNCTION ARG1 ARG2 ..}}
```

다음은 `add` 함수에 1과 2를 집어넣는 
예제입니다.
```Go
{{ add 1 2}}
```

### 함수와 필드는 점을 통해 접근할 수 있다.

front matter로 정의되어있는 `bar` 는 다음과 같이 불러올 수 있습니다.

```Go
{{ .Params.bar }}
```

### 괄호를 사용해 아이템을 그룹지어 사용할 수 있다.

```Go
{{ if or (isset .Params "alt") (isset. Params "caption") }} Caption {{ end }}
```

## 변수
각각의 Go Template은 데이터 객체를 얻는다. 휴고에서, 각 템플릿은 `Page`로 전달된다. 다음 예제에서, `.Title`은 `Page` 변수를 통해 접근할 수 있는 요소중 하나다.

`Page` 변수가 템플릿의 default 스코프로 주어지기 때문에, 현재 스코프(`.`)에 있는 `Title` 요소는 점을 찍어 간단히 접근할 수 있다.(`.Title`)

```Go
<title>{{ .Title }}</title>
```

`$`를 통해 커스텀 변수에 값을 저장할 수도 있다.

> 커스텀 변수는 반드시 `$`를 앞에 붙여줘야 합니다.

```Go
{{ $address := "123 Main St." }}
{{ $address }}
```

휴고 v0.48 부터는 변수에 값을 저장할 때 `=`를 사용할 수 있습니다.

```Go
{{ $var := "Hugo Page" }}
{{ if .IsHome }}
    {{ $var = "Hugo Home" }}
{{ end }}
Var is {{ $var }}
```

## 함수
Go Template은 기본 함수들을 제공할 뿐만 아니라 새로운 함수를 추가할 수 있는 메커니즘을 제공합니다.

Hugo template 함수들은 웹사이트를 생성하는데 필요한 추가적인 기능명세를 제공합니다. 함수들은 함수 이름 다음에 필요한 파라미터를 space로 구분하여 제공하는 것으로 사용가능합니다. 템플릿 함수들은 Hugo에 의해 리컴파일링 되지 않고는 추가될 수 없습니다.

### Example 1: Adding Numbers
```Go
{{ add 1 2 }}
<!-- prints 3 -->
```
### Example 2 : Comparing Numbers
```Go
{{ lt 1 2 }}
<!-- prints true -->
```

두 예제는 Go Template의 math 함수를 이용하고 있음을 주의해라

## 템플릿 불러오기

템플릿을 불러올 때 여러분은 템플릿을 불러오는데 필요한 데이터를 넘겨줘야합니다. 

> 현재 페이지를 넘겨주기 위해선 `.`을 포함시켜야 하는것을 기억하십시오.

템플릿의 위치는 항상 휴고의 `layouts/` 디렉토리 위치에서 시작한다.
### Partial

`partial` 함수는 partial 템플릿을 불러올 때 사용한다. 다음과 같이 사용한다. `{{ partial "<PATH>/<PARTIAL>.<EXTENSION>" . }}`

`layouts/partials/header.html` 템플릿을 불러오는 예제이다.

```Go
{{ partial "header.html" . }}
```

### Template
`template`함수는 예전 버전에선 partial 템플릿을 불러오는데 사용됐지만, 지금은 internal template을 불러오는데만 사용됩니다. 문법은 다음과 같습니다. `{{ template "_internal/<TEMPLATE>.<EXTENSION>" . }}`

>사용가능한 internal 템플릿은 다음 주소를 참고하십시오. https://github.com/gohugoio/hugo/tree/master/tpl/tplimpl/embedded/templates

internal 템플릿인 `opengraph.html` 템플릿을 불러오는 예제입니다.

```Go
{{ template "_internal/opengraph.html" . }}
```

## 로직
Go Template은 아주 기본적인 이터레이터와 조건로직을 제공한다.

### Iteration
Go Template의 `range`를 이용해 map,array 또는 slice를 순회할 수 있습니다. 다음 예제들은 `range`의 다양한 사용법들입니다.

#### Example 1: Using Context (.)
```Go
{{ range $array }}
    {{ . }}
{{ end }}
```
#### Example 2: Declaring a variable name for an array element's value
```Go
{{ range $elem_val := $array }}
    {{ $elem_val }}
{{ end }}
```
#### Example 3: Declaring variable names for an array element's index and value
array나 slice에선 첫번째 선언된 변수에 인덱스가 매치됩니다.
```Go
{{ range $elem_index, $elem_val := $array }}
    {{ $elem_index }} -- {{ $elem_val }}
{{ end }}
```
#### Example 4: Declaring variable names for a map element's key and value
map에선 첫번째 선언된 변수에 key값이 매치됩니다.
```Go
{{ range $elem_key, $elem_val := $map }}
    {{ $elem_key }} -- {{ $elem_val }}
{{ end }}
```
#### Example 5: Conditional on empty map, array, or slice.
map,array 또는 slice가 비어있을 때를 위한 로직을 추가할 수도 있습니다.
```Go
{{ range $array }}
    {{.}}
{{ else }}
    <!-- 만약 $array가 비어있다면 여기있는 로직이 실행됩니다. -->
{{ end }}
``` 

### 조건
`if`,`else`,`with`,`or` 그리고 `and`는 Go Template에서 조건을 핸들링할 수 있는 프레임워크를 제공합니다. `range`처럼 각 로직은 `{{ end }}`로 닫혀야합니다.

Go Template은 다음과 같은 값들을 **false**로 간주합니다.

* `false`(boolean)
* 0 (integer)
* 비어있는 모든 array,slice,map 또는 string

#### Example 1: `with`
'~~가 있으면(존재하면) ~~해라' 식의 조건은 `with`를 사용합니다.

> `range`처럼 `with`도 안의 내용을 `.`.`을 통해 접근하게 됩니다.

`with`는 만약 조건에 부합하거나 해당 변수가 없으면 그 블록을 스킵합니다.
```Go
{{ with .Params.title }}
    <h4>{{ . }}</h4>
{{ end }}
```

#### Example 2: `with`..`else`
다음 예제는 front-matter로 "description"이 있으면 해당 값을 표출하고 없으면 default로`.Summary` 를 표출합니다.
```Go
{{ with .Param "description" }}
    {{ . }}
{{ else }}
    {{ .Summary }}
{{ end }}
```

#### Example 3: `if`
앞서 나온 1번 예제를 `if`를 사용해 다시 써보면 다음과 같습니다. `isset`은 해당 변수가 존재하는지 확인해 true/false로 반환하는 함수입니다. 
```Go
{{ if isset .Params "title" }}
    <h4>{{ index .Params "title" }}</h4>
{{ end }}
```
#### Example 4: `if`..`else`
2번 예제를 `if`..`else`로 다시쓰면 다음과 같습니다.
```Go
{{ if (isset .Params "description") }}
    {{ index .Params "description" }}
{{ else }}
    {{ .Summary }}
{{ end }}
```
#### Example 5: `if`..`else if`..`else`
`with`과 다르게 `if`는 `else if`를 통해 조건을 계속 추가할 수 있습니다.
```Go
{{ if (isset .Params "description") }}
    {{ index .Params "description" }}
{{ else if (isset .Params "summary") }}
    {{ index .Params "summary" }}
{{ else }}
    {{ .Summary }}
{{ end }}
```
#### Example 6: `and` & `or`
```Go
{{ if (and (or (isset .Params "title") (isset .Params "caption")) (isset .Params "attr")) }}
```
## 파이프라인
Go Template의 가장 강력한 구성요소중 하나는 명령을 쌓을 수 있다는 것입니다. pipe를 사용해 그렇게할 수 있다. pipe는 Unix pipe에서 빌려온 개념으로, 간단하다. 각 파이프라인의 결과는 다음 파이프라인의 input이 됩니다.

아주 간단한 Go Template의 문법 덕분에 파이프는 함수 호출도 함께 연결할 수 있습니다. 단점은 하나뿐입니다. 파이프라인은 한가지 값만을 반환할 수 있고 그 값은 다음 파이프라인의 마지막 파라미터가 된다는 것입니다. 

### Example 1: `shuffle`
다음 두 예제는 완전히 동일하게 작동합니다.
```Go
{{ shuffle (seq 1 5) }}
```
```Go
{{ (seq 1 5) | shuffle }}
```
### Example 2: `index`
다음 예제는 "disqus_url"이라는 page parameter를 html형식으로 출력하는 예제입니다. 또한, 이 예제는 `index` 함수를 사용하는데 이 함수는 1번 파라미터의 2번파라미터 key에 해당하는 값을 불러옵니다.(ex. index $array 1 => $array[1], index $dict "a" => $dict["a"])

```Go
{{ index .Params "disqus_url" | html }}
```
### Example 3: `or` with `isset`
```Go
{{ if or (or (isset .Params "title") (isset .Params "caption")) (isset .Params "attr") }}
Stuff Here
{{ end }}
```
위 예제는 다음과 같이 다시 쓰일 수 있습니다.
```Go
{{ if isset .Params "caption" | or isset .Params "title" | or isset .Params "attr" }}
Stuff Here
{{ end }}
```
### Example 4: Internet Explorer Conditional Comments

기본적으로 , Go Template은 HTML 주석을 결과에서 제거합니다. 

이 기능은 인터넷익스플로어 버전을 검사하는 부수효과를 냅니다.

```Go
{{ "<!--[if lt IE 9]>" | safeHTML }}
  <script src="html5shiv.js"></script>
{{ "<![endif]-->" | safeHTML }}
```

다른 방법으로 백틱(<code>`</code>)을 사용할 수도 있습니다. 
```Go
{{ `<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"><![endif]-->` | safeHTML }}
```

## Context (aka "the dot")
Go Template에 대해 이해하는데 가장 쉽게 간과되곤 하는 개념이 `{{ . }}`는 항상 현재 내용을 참조한다는 것입니다.

* `.`은 여러분이 만든 템플릿의 가장 상위에서 사용할 수 있는 데이터 셋이 됩니다.

* 이터레이터 안에서 `.`은 현재 아이템이 됩니다.

### 1. Define a Variable Independent of Context

다음 예제는 어떻게 독립 변수를 로직안에 정의할 수 있는지 알려주는 예제입니다.
```Go
{{ $title := .Site.Title }}
<ul>
{{ range .Params.tags }}
    <li>
        <a href="/tags/{{ . | urlize }}">{{ . }}</a>
        - {{ $title }}
    </li>
{{ end }}
</ul>
```

### 2. Use `$.` to Access the Global Context
여러분의 템플릿에서 `$`는 특별한 문자입니다. `$` 는 기본적으로 `.`의 시작값입니다. 이는 글로벌 스코프에 어느곳에서든 접근할 수 있다는 뜻입니다.

```Go
<ul>
{{ range .Params.tags }}
  <li>
    <a href="/tags/{{ . | urlize }}">{{ . }}</a>
            - {{ $.Site.Title }}
  </li>
{{ end }}
</ul>
```
## Whitespace(공백)
`-` 기호는 `{{` 또는 `}}` 옆의 공백을 지워줍니다.

```Go
<div>
    {{ .Title }}
</div>
```
결과:
```html
<div>
    Hello, World!
</div>
```

이제 `-`를 사용하면 이렇게 됩니다.

```Go
<div>
    {{- .Title -}}
</div>
```
결과:
```html
<div>Hello, World!</div>
```

Go는 다음을 공백으로 여깁니다.

* space
* horizontal tab
* carriage return
* newline

## 주석
템플릿에 주석을 추가할 수 있습니다. Hugo엔 두 가지 주석을 다는 방법이 있습니다.

### Go Templates 주석
Go Template은 `{{/*`와 `*/}}`로 주석을 달 수 있습니다.

```Go
Bonsoir, {{/* {{ add 0 + 2}} */}}Eliott.
```

결과는 `Bonsoir, Eliott.`가 됩니다. 

### HTML 주석
여러분의 템플릿에 HTML 주석을 달 일이 있다면 https://gohugo.io/templates/introduction/#ie-conditional-comments를 참고하십시오. 만약 HTML 주석에 변수를 사용해야 한다면 다음과 같은 방법이 있습니다.
```Go
{{ printf "<!-- Our website is named: %s -->" .Site.Title | safeHTML }}
```

### Go Template에 포함된 HTML 주석
HTML 주석에 포함된 Go Template도 랜더링이 됩니다.
> 하지만 그렇게 하지는 말아주십시오.
```Go
<!-- {{ $author := "Emma Goldman" }} was a great woman. -->
{{ $author }}
```

위 예제는 `Emma Goldman`을 정상적으로 렌더링 합니다. 그러나 HTML 주석 안의 코드가 에러를 낸다면 렌더링에 실패합니다.

  